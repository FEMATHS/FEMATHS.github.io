"use strict";(self.webpackChunkcm_fesmpn_space=self.webpackChunkcm_fesmpn_space||[]).push([[5572],{16514:(s,e,n)=>{n.r(e),n.d(e,{assets:()=>m,contentTitle:()=>r,default:()=>d,frontMatter:()=>t,metadata:()=>a,toc:()=>c});var a=n(77367),l=n(74848),i=n(28453);const t={title:"Related GANs and their SRGAN ablation experiments",authors:["zqqqj"],tags:[],date:new Date("2025-06-16T00:00:00.000Z")},r="GAN \u5bf9\u6297\u795e\u7ecf\u7f51\u7edc\u53ca\u5176\u53d8\u79cd\uff08\u7406\u8bba\u90e8\u5206\uff09",m={authorsImageUrls:[void 0]},c=[{value:"1. GAN\uff08Generative Adversarial Network\uff09\u751f\u6210\u5bf9\u6297\u7f51\u7edc",id:"1-gangenerative-adversarial-network\u751f\u6210\u5bf9\u6297\u7f51\u7edc",level:2},{value:"2. cGAN\uff08Conditional GAN\uff09\u6761\u4ef6\u751f\u6210\u5bf9\u6297\u7f51\u7edc",id:"2-cganconditional-gan\u6761\u4ef6\u751f\u6210\u5bf9\u6297\u7f51\u7edc",level:2},{value:"3. SRGAN",id:"3-srgan",level:2},{value:"4. ESRGAN",id:"4-esrgan",level:2},{value:"\u603b\u7ed3\uff08\u7406\u8bba\u90e8\u5206\uff09",id:"\u603b\u7ed3\u7406\u8bba\u90e8\u5206",level:2},{value:"1. cGAN",id:"1-cgan",level:2},{value:"1.1 \u5b89\u88c5\u9700\u8981\u7684\u5305\u4e0e\u73af\u5883",id:"11-\u5b89\u88c5\u9700\u8981\u7684\u5305\u4e0e\u73af\u5883",level:3},{value:"1.2 \u6570\u636e\u9884\u5904\u7406",id:"12-\u6570\u636e\u9884\u5904\u7406",level:3},{value:"1.3 \u81ea\u5b9a\u4e49\u6570\u636e\u96c6\u7c7b",id:"13-\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\u7c7b",level:3},{value:"1.4 \u5b9a\u4e49\u751f\u6210\u5668",id:"14-\u5b9a\u4e49\u751f\u6210\u5668",level:3},{value:"1.5 \u5b9a\u4e49\u5224\u522b\u5668",id:"15-\u5b9a\u4e49\u5224\u522b\u5668",level:3},{value:"1.6 \u8ba1\u7b97\u6307\u6807",id:"16-\u8ba1\u7b97\u6307\u6807",level:3},{value:"1.7 \u52a0\u8f7d\u6570\u636e\u96c6\uff0c\u51c6\u5907\u8bad\u7ec3",id:"17-\u52a0\u8f7d\u6570\u636e\u96c6\u51c6\u5907\u8bad\u7ec3",level:3},{value:"1.8 \u6a21\u578b\u8bad\u7ec3",id:"18-\u6a21\u578b\u8bad\u7ec3",level:3},{value:"1.9 \u6a21\u578b\u9a8c\u8bc1",id:"19-\u6a21\u578b\u9a8c\u8bc1",level:3},{value:"1.10 \u4fdd\u5b58",id:"110-\u4fdd\u5b58",level:3},{value:"2. SRGAN",id:"2-srgan",level:2},{value:"2.1 \u751f\u6210\u5668\u6a21\u578b SRResNetGenerator",id:"21-\u751f\u6210\u5668\u6a21\u578b-srresnetgenerator",level:3},{value:"2.2 \u5b9a\u4e49\u5224\u522b\u5668 Discriminator",id:"22-\u5b9a\u4e49\u5224\u522b\u5668-discriminator",level:3},{value:"3. ESRGAN",id:"3-esrgan",level:2},{value:"3.1 \u751f\u6210\u5668\u6a21\u578b RDBNet",id:"31-\u751f\u6210\u5668\u6a21\u578b-rdbnet",level:3},{value:"3.2 \u5224\u522b\u5668\u6a21\u578b ESRDiscriminator",id:"32-\u5224\u522b\u5668\u6a21\u578b-esrdiscriminator",level:3},{value:"1. \u635f\u5931\u51fd\u6570\u6539\u8fdb\u7248",id:"1-\u635f\u5931\u51fd\u6570\u6539\u8fdb\u7248",level:2},{value:"2. \u901a\u9053\u6ce8\u610f\u529b\u673a\u5236\u7248",id:"2-\u901a\u9053\u6ce8\u610f\u529b\u673a\u5236\u7248",level:2},{value:"3. \u591a\u5c3a\u5ea6\u7279\u5f81\u878d\u5408\u7248",id:"3-\u591a\u5c3a\u5ea6\u7279\u5f81\u878d\u5408\u7248",level:2},{value:"4. \u878d\u5408",id:"4-\u878d\u5408",level:2},{value:"5. \u603b\u7ed3",id:"5-\u603b\u7ed3",level:2}];function h(s){const e={a:"a",annotation:"annotation",code:"code",h1:"h1",h2:"h2",h3:"h3",hr:"hr",li:"li",math:"math",mfrac:"mfrac",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",msqrt:"msqrt",msub:"msub",msubsup:"msubsup",msup:"msup",mtext:"mtext",munder:"munder",munderover:"munderover",ol:"ol",p:"p",path:"path",pre:"pre",semantics:"semantics",span:"span",strong:"strong",svg:"svg",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.R)(),...s.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.p,{children:"\u672c\u6587\u5c06\u4ece\u4e09\u90e8\u5206\uff0c\u5373 GAN \u6a21\u578b\u7684\u7406\u8bba\u90e8\u5206\uff0c\u4ee3\u7801\uff08\u5b9e\u8df5\uff09\u90e8\u5206\u53ca SRGAN \u7684\u6d88\u878d\u8bd5\u9a8c\u90e8\u5206\u5c55\u5f00\u4ecb\u7ecd"}),"\n",(0,l.jsx)(e.h2,{id:"1-gangenerative-adversarial-network\u751f\u6210\u5bf9\u6297\u7f51\u7edc",children:"1. GAN\uff08Generative Adversarial Network\uff09\u751f\u6210\u5bf9\u6297\u7f51\u7edc"}),"\n",(0,l.jsx)(e.p,{children:"\u6838\u5fc3\uff1a\u7531\u4e24\u4e2a\u795e\u7ecf\u7f51\u7edc\u2014\u2014\u751f\u6210\u5668\uff08Generator\uff09\u548c\u5224\u522b\u5668\uff08Discriminator\uff09\u7ec4\u6210\uff0c\u901a\u8fc7\u535a\u5f08\u8fc7\u7a0b\u76f8\u4e92\u63d0\u5347\u3002\n\xb7 \u751f\u6210\u5668\uff1a\u8bd5\u56fe\u201c\u4f2a\u9020\u201d\u4ee5\u5047\u4e71\u771f\u7684\u6570\u636e\u3002\n\xb7 \u5224\u522b\u5668\uff1a\u5224\u65ad\u8f93\u5165\u662f\u771f\u5b9e\u6570\u636e\u8fd8\u662f\u751f\u6210\u5668\u4f2a\u9020\u7684\u3002\n\xb7 \u8bad\u7ec3\u76ee\u6807\uff1a\u751f\u6210\u5668\u5e0c\u671b\u9a97\u8fc7\u5224\u522b\u5668\uff0c\u5224\u522b\u5668\u5e0c\u671b\u51c6\u786e\u8bc6\u522b\u771f\u5047\u3002\n\u672c\u8d28\u4e0a\u662f\u4e00\u4e2a\u6700\u5927\u6700\u5c0f\u95ee\u9898\uff1a"}),"\n",(0,l.jsx)(e.span,{className:"katex-display",children:(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsxs)(e.munder,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"min"}),(0,l.jsx)(e.mo,{children:"\u2061"})]}),(0,l.jsx)(e.mi,{children:"G"})]}),(0,l.jsxs)(e.munder,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"max"}),(0,l.jsx)(e.mo,{children:"\u2061"})]}),(0,l.jsx)(e.mi,{children:"D"})]}),(0,l.jsx)(e.mtext,{children:"\xa0"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{mathvariant:"double-struck",children:"E"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mo,{children:"\u223c"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mtext,{children:"data"})]})]})]}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{fence:"true",children:"["}),(0,l.jsx)(e.mi,{children:"log"}),(0,l.jsx)(e.mo,{children:"\u2061"}),(0,l.jsx)(e.mi,{children:"D"}),(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"}),(0,l.jsx)(e.mo,{fence:"true",children:"]"})]}),(0,l.jsx)(e.mo,{children:"+"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{mathvariant:"double-struck",children:"E"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"z"}),(0,l.jsx)(e.mo,{children:"\u223c"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mi,{children:"z"})]})]})]}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{fence:"true",children:"["}),(0,l.jsx)(e.mi,{children:"log"}),(0,l.jsx)(e.mo,{children:"\u2061"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{fence:"true",children:"("}),(0,l.jsx)(e.mn,{children:"1"}),(0,l.jsx)(e.mo,{children:"\u2212"}),(0,l.jsx)(e.mi,{children:"D"}),(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsx)(e.mi,{children:"G"}),(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsx)(e.mi,{children:"z"}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"}),(0,l.jsx)(e.mo,{fence:"true",children:")"})]}),(0,l.jsx)(e.mo,{fence:"true",children:"]"})]})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\min_G \\max_D \\ \\mathbb{E}_{x \\sim p_{\\text{data}}} \\left[ \\log D(x) \\right] + \\mathbb{E}_{z \\sim p_z} \\left[ \\log \\left(1 - D(G(z)) \\right) \\right]\n"})]})})}),(0,l.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"1.4943em",verticalAlign:"-0.7443em"}}),(0,l.jsx)(e.span,{className:"mop op-limits",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.3557em",marginLeft:"0em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"G"})})]}),(0,l.jsxs)(e.span,{style:{top:"-3em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{children:(0,l.jsx)(e.span,{className:"mop",children:"min"})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.7443em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(e.span,{className:"mop op-limits",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"0.4306em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.3557em",marginLeft:"0em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"D"})})]}),(0,l.jsxs)(e.span,{style:{top:"-3em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{children:(0,l.jsx)(e.span,{className:"mop",children:"max"})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.7443em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mspace",children:"\xa0"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathbb",children:"E"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"}),(0,l.jsx)(e.span,{className:"mrel mtight",children:"\u223c"}),(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.3488em",marginLeft:"0em",marginRight:"0.0714em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord text mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"data"})})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1512em"},children:(0,l.jsx)(e.span,{})})})]})})]})]})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"minner",children:[(0,l.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:"["}),(0,l.jsxs)(e.span,{className:"mop",children:["lo",(0,l.jsx)(e.span,{style:{marginRight:"0.01389em"},children:"g"})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"}),(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,l.jsx)(e.span,{className:"mclose",children:")"}),(0,l.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:"]"})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"+"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"1.0361em",verticalAlign:"-0.2861em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathbb",children:"E"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.04398em"},children:"z"}),(0,l.jsx)(e.span,{className:"mrel mtight",children:"\u223c"}),(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1645em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.357em",marginLeft:"0em",marginRight:"0.0714em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.04398em"},children:"z"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.143em"},children:(0,l.jsx)(e.span,{})})})]})})]})]})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"minner",children:[(0,l.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:"["}),(0,l.jsxs)(e.span,{className:"mop",children:["lo",(0,l.jsx)(e.span,{style:{marginRight:"0.01389em"},children:"g"})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"minner",children:[(0,l.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:"("}),(0,l.jsx)(e.span,{className:"mord",children:"1"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"}),(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsx)(e.span,{className:"mord mathnormal",children:"G"}),(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.04398em"},children:"z"}),(0,l.jsx)(e.span,{className:"mclose",children:"))"}),(0,l.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:")"})]}),(0,l.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:"]"})]})]})]})]})}),"\n",(0,l.jsx)(e.h2,{id:"2-cganconditional-gan\u6761\u4ef6\u751f\u6210\u5bf9\u6297\u7f51\u7edc",children:"2. cGAN\uff08Conditional GAN\uff09\u6761\u4ef6\u751f\u6210\u5bf9\u6297\u7f51\u7edc"}),"\n",(0,l.jsx)(e.p,{children:"\u6838\u5fc3\uff1a\u5728 GAN \u7684\u57fa\u7840\u4e0a\uff0c\u5f15\u5165\u201c\u6761\u4ef6\u201d\u4fe1\u606f\uff08\u5982\u6807\u7b7e\u3001\u56fe\u50cf\u3001\u6587\u672c\u7b49\uff09\n\xb7 \u751f\u6210\u5668\u548c\u5224\u522b\u5668\u90fd\u63a5\u6536\u6761\u4ef6\u53d8\u91cf\n\xb7 G\uff08z\uff0cy\uff09\uff1a\u5728\u6761\u4ef6 y \u4e0b\u751f\u6210\u56fe\u50cf\n\xb7 D\uff08x\uff0cy\uff09\uff1a\u5224\u65ad\u56fe\u50cf\u662f\u5426\u4e3a\u5728\u6761\u4ef6 y \u4e0b\u771f\u5b9e\u7684\n\u7528\u9014\uff1a\u56fe\u50cf\u7ffb\u8bd1\uff08\u5982\u9ed1\u767d\u56fe\u50cf\u4e0a\u8272\uff09\u3001\u8bed\u4e49\u56fe\u751f\u6210\u56fe\u50cf\u3001\u6587\u672c\u751f\u6210\u56fe\u50cf\n\u76ee\u6807\u51fd\u6570\uff1a"}),"\n",(0,l.jsx)(e.span,{className:"katex-display",children:(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsxs)(e.munder,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"min"}),(0,l.jsx)(e.mo,{children:"\u2061"})]}),(0,l.jsx)(e.mi,{children:"G"})]}),(0,l.jsxs)(e.munder,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"max"}),(0,l.jsx)(e.mo,{children:"\u2061"})]}),(0,l.jsx)(e.mi,{children:"D"})]}),(0,l.jsx)(e.mtext,{children:"\xa0"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{mathvariant:"double-struck",children:"E"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mo,{separator:"true",children:","}),(0,l.jsx)(e.mi,{children:"y"}),(0,l.jsx)(e.mo,{children:"\u223c"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mtext,{children:"data"})]})]})]}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{fence:"true",children:"["}),(0,l.jsx)(e.mi,{children:"log"}),(0,l.jsx)(e.mo,{children:"\u2061"}),(0,l.jsx)(e.mi,{children:"D"}),(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsx)(e.mi,{children:"y"}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"}),(0,l.jsx)(e.mo,{fence:"true",children:"]"})]}),(0,l.jsx)(e.mo,{children:"+"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{mathvariant:"double-struck",children:"E"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"z"}),(0,l.jsx)(e.mo,{children:"\u223c"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"p"}),(0,l.jsx)(e.mi,{children:"z"})]})]})]}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{fence:"true",children:"["}),(0,l.jsx)(e.mi,{children:"log"}),(0,l.jsx)(e.mo,{children:"\u2061"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{fence:"true",children:"("}),(0,l.jsx)(e.mn,{children:"1"}),(0,l.jsx)(e.mo,{children:"\u2212"}),(0,l.jsx)(e.mi,{children:"D"}),(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsx)(e.mi,{children:"G"}),(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsx)(e.mi,{children:"z"}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsx)(e.mi,{children:"y"}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"}),(0,l.jsx)(e.mo,{fence:"true",children:")"})]}),(0,l.jsx)(e.mo,{fence:"true",children:"]"})]})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\min_G \\max_D \\ \\mathbb{E}_{x,y \\sim p_{\\text{data}}} \\left[ \\log D(x|y) \\right] + \\mathbb{E}_{z \\sim p_z} \\left[ \\log \\left(1 - D(G(z|y)) \\right) \\right]\n\n"})]})})}),(0,l.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"1.4943em",verticalAlign:"-0.7443em"}}),(0,l.jsx)(e.span,{className:"mop op-limits",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"0.6679em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.3557em",marginLeft:"0em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"G"})})]}),(0,l.jsxs)(e.span,{style:{top:"-3em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{children:(0,l.jsx)(e.span,{className:"mop",children:"min"})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.7443em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(e.span,{className:"mop op-limits",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"0.4306em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.3557em",marginLeft:"0em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.02778em"},children:"D"})})]}),(0,l.jsxs)(e.span,{style:{top:"-3em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{children:(0,l.jsx)(e.span,{className:"mop",children:"max"})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.7443em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mspace",children:"\xa0"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathbb",children:"E"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"}),(0,l.jsx)(e.span,{className:"mpunct mtight",children:","}),(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"}),(0,l.jsx)(e.span,{className:"mrel mtight",children:"\u223c"}),(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3448em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.3488em",marginLeft:"0em",marginRight:"0.0714em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord text mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"data"})})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1512em"},children:(0,l.jsx)(e.span,{})})})]})})]})]})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"minner",children:[(0,l.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:"["}),(0,l.jsxs)(e.span,{className:"mop",children:["lo",(0,l.jsx)(e.span,{style:{marginRight:"0.01389em"},children:"g"})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"}),(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,l.jsx)(e.span,{className:"mord",children:"\u2223"}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,l.jsx)(e.span,{className:"mclose",children:")"}),(0,l.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:"]"})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"+"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"1.0361em",verticalAlign:"-0.2861em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathbb",children:"E"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.04398em"},children:"z"}),(0,l.jsx)(e.span,{className:"mrel mtight",children:"\u223c"}),(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"p"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1645em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.357em",marginLeft:"0em",marginRight:"0.0714em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.5em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size3 size1 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.04398em"},children:"z"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.143em"},children:(0,l.jsx)(e.span,{})})})]})})]})]})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"minner",children:[(0,l.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:"["}),(0,l.jsxs)(e.span,{className:"mop",children:["lo",(0,l.jsx)(e.span,{style:{marginRight:"0.01389em"},children:"g"})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"minner",children:[(0,l.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:"("}),(0,l.jsx)(e.span,{className:"mord",children:"1"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"D"}),(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsx)(e.span,{className:"mord mathnormal",children:"G"}),(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.04398em"},children:"z"}),(0,l.jsx)(e.span,{className:"mord",children:"\u2223"}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,l.jsx)(e.span,{className:"mclose",children:"))"}),(0,l.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:")"})]}),(0,l.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:"]"})]})]})]})]})}),"\n",(0,l.jsx)(e.h2,{id:"3-srgan",children:"3. SRGAN"}),"\n",(0,l.jsx)(e.p,{children:"\u76ee\u7684\uff1a\u56fe\u50cf\u8d85\u5206\u8fa8\u7387\uff0c\u5373\u5c06\u4f4e\u5206\u8fa8\u7387\u56fe\u50cf\uff08LR\uff09\u8fd8\u539f\u6210\u9ad8\u5206\u8fa8\u7387\u56fe\u50cf\uff08HR\uff09\n\xb7 \u751f\u6210\u5668\u7ed3\u6784\uff1a\u4f7f\u7528\u6b8b\u5dee\u7f51\u7edc\uff08ResNet\uff09\u8fdb\u884c\u7ec6\u8282\u91cd\u5efa\u3002\n\xb7 \u5224\u522b\u5668\uff1a\u533a\u5206\u751f\u6210\u7684\u9ad8\u5206\u56fe\u50cf\u548c\u771f\u5b9e\u9ad8\u5206\u56fe\u50cf\u3002\n\u635f\u5931\u51fd\u6570\u5305\u542b\uff1a\n\xb7 \u5185\u5bb9\u635f\u5931\uff08\u5982 MSE \u6216\u611f\u77e5\u635f\u5931\uff09\uff1b\n\xb7 \u5bf9\u6297\u635f\u5931\uff08\u5224\u522b\u5668\u8f93\u51fa\uff09\n\xb7 \u611f\u77e5\u635f\u5931\uff08Perceptual Loss\uff09\uff1a\u5728 VGG \u7f51\u7edc\u7684\u9ad8\u5c42 feature \u4e0a\u8ba1\u7b97\u5dee\u5f02\uff0c\u66f4\u8d34\u8fd1\u4eba\u7c7b\u89c6\u89c9\u611f\u53d7"}),"\n",(0,l.jsx)(e.h2,{id:"4-esrgan",children:"4. ESRGAN"}),"\n",(0,l.jsx)(e.p,{children:"\u57fa\u4e8e SRGAN\uff0c\u5177\u6709\u5982\u4e0b\u4f18\u52bf\uff1a"}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsx)(e.li,{children:"Residual-in-Residual Dense Block (RRDB)\uff1a\u66ff\u6362\u539f SRGAN \u7684\u6b8b\u5dee\u5757\uff0c\u7ed3\u6784\u66f4\u6df1\uff0c\u4fe1\u606f\u6d41\u66f4\u4e30\u5bcc\u3002"}),"\n",(0,l.jsx)(e.li,{children:"\u5bf9\u6297\u635f\u5931\u6539\u8fdb\uff1a\u91c7\u7528 Relativistic average GAN\uff08RaGAN\uff09\uff0c\u5373\u5224\u65ad\u201c\u751f\u6210\u56fe\u662f\u5426\u6bd4\u771f\u5b9e\u56fe\u66f4\u5047\u201d\uff0c\u800c\u4e0d\u662f\u7b80\u5355\u5224\u65ad\u771f\u5047\u3002"}),"\n",(0,l.jsx)(e.li,{children:"\u611f\u77e5\u635f\u5931\u4f18\u5316\uff1a\u4f7f\u7528\u672a\u5f52\u4e00\u5316\u7684 VGG \u7279\u5f81\u56fe\uff0c\u907f\u514d\u56fe\u50cf\u8fc7\u5149\u6ed1\u3002"}),"\n",(0,l.jsx)(e.li,{children:"\u8bad\u7ec3\u6280\u5de7\uff1a\u4f7f\u7528\u591a\u9636\u6bb5\u8bad\u7ec3\uff0c\u5305\u62ec\u5148\u8bad\u7ec3\u5185\u5bb9\u635f\u5931\uff0c\u518d\u52a0\u5165\u5bf9\u6297\u8bad\u7ec3"}),"\n"]}),"\n",(0,l.jsx)(e.h2,{id:"\u603b\u7ed3\u7406\u8bba\u90e8\u5206",children:"\u603b\u7ed3\uff08\u7406\u8bba\u90e8\u5206\uff09"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"\u540d\u79f0"}),(0,l.jsx)(e.th,{children:"\u5168\u79f0"}),(0,l.jsx)(e.th,{children:"\u7c7b\u578b"}),(0,l.jsx)(e.th,{children:"\u7279\u70b9\u6982\u8ff0"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"GAN"}),(0,l.jsx)(e.td,{children:"Generative Adversarial Net"}),(0,l.jsx)(e.td,{children:"\u65e0\u76d1\u7763\u751f\u6210"}),(0,l.jsx)(e.td,{children:"\u5bf9\u6297\u751f\u6210\u56fe\u50cf"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"cGAN"}),(0,l.jsx)(e.td,{children:"Conditional GAN"}),(0,l.jsx)(e.td,{children:"\u6761\u4ef6\u751f\u6210"}),(0,l.jsx)(e.td,{children:"\u52a0\u5165\u6807\u7b7e\u6216\u6761\u4ef6\u8fdb\u884c\u63a7\u5236"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"SRGAN"}),(0,l.jsx)(e.td,{children:"Super-Resolution GAN"}),(0,l.jsx)(e.td,{children:"\u56fe\u50cf\u8d85\u5206\u8fa8\u7387"}),(0,l.jsx)(e.td,{children:"\u4f7f\u7528\u611f\u77e5\u635f\u5931\uff0c\u751f\u6210\u81ea\u7136\u9ad8\u5206\u56fe\u50cf"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"ESRGAN"}),(0,l.jsx)(e.td,{children:"Enhanced SRGAN"}),(0,l.jsx)(e.td,{children:"\u56fe\u50cf\u8d85\u5206\u8fa8\u7387"}),(0,l.jsx)(e.td,{children:"\u52a0\u5f3a\u7f51\u7edc\u7ed3\u6784\u548c\u635f\u5931\u51fd\u6570\uff0c\u7ec6\u8282\u66f4\u4f73"})]})]})]}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsxs)(e.strong,{children:["\u5728\u540e\u6587\u7684\u8bd5\u9a8c\u4e2d\uff0c\u539f\u59cb\u4ee3\u7801\u4e0e\u6570\u636e\u96c6\u7686\u5b58\u653e\u5728 GitHub \u4ed3\u5e93\uff1a",(0,l.jsx)(e.a,{href:"https://github.com/zqqqqqqj1110/GAN_WB",children:"https://github.com/zqqqqqqj1110/GAN_WB"})]})}),"\n",(0,l.jsx)(e.h1,{id:"gan-\u5bf9\u6297\u795e\u7ecf\u7f51\u7edc\u53ca\u5176\u53d8\u79cd\u8bd5\u9a8c\u90e8\u5206",children:"GAN \u5bf9\u6297\u795e\u7ecf\u7f51\u7edc\u53ca\u5176\u53d8\u79cd\uff08\u8bd5\u9a8c\u90e8\u5206\uff09"}),"\n",(0,l.jsx)(e.h2,{id:"1-cgan",children:"1. cGAN"}),"\n",(0,l.jsx)(e.p,{children:"\u672c\u6587\u4ee5 cGAN \u4f5c\u4e3a baseline\uff0c\u540e\u7eed\u7684 gan \u53d8\u79cd\u6a21\u578b\u7686\u7531\u8be5\u90e8\u5206\u4ee3\u7801\u53d8\u6362\u800c\u6765\uff0c\u56e0\u6b64\u5728\u8fd9\u90e8\u5206\u4f1a\u8bb2\u7684\u8f83\u4e3a\u5168\u9762\u4e00\u4e9b\uff0c\u540e\u6587\u53ef\u80fd\u4f1a\u7701\u7565"}),"\n",(0,l.jsx)(e.h3,{id:"11-\u5b89\u88c5\u9700\u8981\u7684\u5305\u4e0e\u73af\u5883",children:"1.1 \u5b89\u88c5\u9700\u8981\u7684\u5305\u4e0e\u73af\u5883"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'import numpy as np\nimport pandas as pd\nimport torch\nimport torch.nn as nn\nimport torch.nn.functional as F\nimport torch.optim as optim\nfrom torch.utils.data import Dataset, DataLoader\nfrom skimage.metrics import peak_signal_noise_ratio, structural_similarity\nimport matplotlib.pyplot as plt\nfrom pytorch_msssim import ms_ssim\n\ndevice = torch.device("mps" if torch.backends.mps.is_available() else "cpu")\nprint(device)\n'})}),"\n",(0,l.jsx)(e.p,{children:"\u4f5c\u8005\u4f7f\u7528\u7684\u662f MacOS\uff0c\u56e0\u6b64\u4f7f\u7528\u4e86 mps\uff0c\u5982\u679c\u662f cuda \u7684\u8bdd\u76f4\u63a5\u6362\u6210\u201ccuda\u201d\u5373\u53ef\uff0c\u914d\u7f6e\u73af\u5883\u90e8\u5206\uff08gpu \u73af\u5883\uff09\u53ef\u8f6c\u5230\u6211\u7684\u4e2a\u4eba\u535a\u5ba2\u5904\u67e5\u9605\uff08\u6216\u8005\u5728\u8fd9\u66f4\uff0c\u61d2\u4e86\uff0c\u5c0f\u9e3d\u4e00\u4e0b^_^\uff09"}),"\n",(0,l.jsx)(e.h3,{id:"12-\u6570\u636e\u9884\u5904\u7406",children:"1.2 \u6570\u636e\u9884\u5904\u7406"}),"\n",(0,l.jsx)(e.p,{children:"\u9996\u5148\u9700\u8981\u52a0\u8f7d\u539f\u59cb\u7684\u6570\u636e\u96c6\uff0c\u63a5\u7740\u5728\u4f4e\u5206\u8fa8\u7387\u4e0b\u751f\u6210\u6570\u636e\uff08\u4e0b\u91c7\u6837\uff09\u4e0e\u4fdd\u5b58\uff08\u901a\u8fc7\u53cc\u7ebf\u6027\u63d2\u503c\u7684\u65b9\u6cd5\uff09\uff0c\u6700\u540e\u8ba1\u7b97 mean\uff0cstd \u7b49\u6807\u51c6\u6307\u6807\uff08\u90fd\u662f\u540e\u9762\u9700\u8981\u7528\u5230\u7684\uff0c\u4e3a\u4e86\u8ba1\u7b97\u6307\u6807\uff0c\u4e0d\u5982\u624b\u52a8\u81ea\u5df1\u8ba1\u7b97\u4e00\u4e0b\uff09"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'# === 1. \u52a0\u8f7d\u539f\u59cb HR \u6570\u636e ===\nhr_train = np.load("seasonal_split/HR_data_train_tm_Summer.npy")[:200]\nhr_valid = np.load("seasonal_split/HR_data_valid_tm_Summer.npy")[:200]\nhr_test = np.load("seasonal_split/HR_data_test_tm_Summer.npy")[:200]\n\n# === 2. \u751f\u6210 LR \u6570\u636e\uff08\u53cc\u7ebf\u6027\u63d2\u503c\u81f3 16\xd716\uff09 ===\ndef downsample(hr_array, scale=4):\n    tensor = torch.tensor(hr_array, dtype=torch.float32)\n    return F.interpolate(tensor, scale_factor=1/scale, mode="bilinear", align_corners=False).numpy()\n\nlr_train = downsample(hr_train)\nlr_valid = downsample(hr_valid)\nlr_test = downsample(hr_test)\n\n# === 3. \u4fdd\u5b58\u4e3a .npy \u6587\u4ef6 ===\nnp.save("tm/HR_data_train_40.npy", hr_train)\nnp.save("tm/LR_data_train_40.npy", lr_train)\nnp.save("tm/HR_data_valid_40.npy", hr_valid)\nnp.save("tm/LR_data_valid_40.npy", lr_valid)\nnp.save("tm/HR_data_test_40.npy", hr_test)\nnp.save("tm/LR_data_test_40.npy", lr_test)\n\n# === 4. mean\u548cstd===\nmean = np.mean(hr_train, axis=(0, 2, 3))[:, None, None]\nstd = np.std(hr_train, axis=(0, 2, 3))[:, None, None]\nnp.save("tm/mean_40.npy", mean)\nnp.save("tm/std_40.npy", std)\n\n# \u6bcf\u4e2a\u901a\u9053\u7684 min \u548c max\uff08\u4f8b\u5982 2 \u4e2a\u901a\u9053\uff09\nhr_min = hr_train.min(axis=(0, 2, 3))  # shape: (2,)\nhr_max = hr_train.max(axis=(0, 2, 3))\n\n# \u4fdd\u5b58\u4e3a .npy \u6587\u4ef6\uff0c\u540e\u7eed\u8bc4\u4f30\u4f7f\u7528\nnp.save("tm/min_40.npy", hr_min.astype(np.float32))\nnp.save("tm/max_40.npy", hr_max.astype(np.float32))\n\nprint("\u5b8c\u6210\uff1a\u751f\u6210 LR/HR \u5207\u7247\u3001\u4fdd\u5b58\u5f52\u4e00\u5316\u53c2\u6570\uff0c\u5305\u62ec test")\n'})}),"\n",(0,l.jsx)(e.h3,{id:"13-\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\u7c7b",children:"1.3 \u81ea\u5b9a\u4e49\u6570\u636e\u96c6\u7c7b"}),"\n",(0,l.jsx)(e.p,{children:"\u4e3a\u4e86\u540e\u7eed\u65b9\u4fbf\u8bad\u7ec3\uff0c\u81ea\u5b9a\u4e49\u6570\u636e\u96c6\u7c7b\uff0c\u4e3b\u8981\u662f\u4e3a\u4e86\u53d8\u5f62\u7b49\u64cd\u4f5c\u3002\u6700\u7ec8\u76ee\u7684\u662f\u5bf9\u6bcf\u5f20\u56fe\u8fdb\u884c\u5f52\u4e00\u5316\uff08\u6807\u51c6\u5316\uff09\u5e76\u7528\u4e8e DataLoader \u52a0\u8f7d\u8bad\u7ec3/\u9a8c\u8bc1\u6570\u636e"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"class WeatherDataset(Dataset):\n    def __init__(self, lr_path, hr_path, mean_path, std_path):\n        self.lr = np.load(lr_path)\n        self.hr = np.load(hr_path)\n        self.mean = np.load(mean_path).reshape(2, 1, 1)\n        self.std = np.load(std_path).reshape(2, 1, 1)\n\n    def __len__(self):\n        return len(self.lr)\n\n    def __getitem__(self, idx):\n        lr = (self.lr[idx] - self.mean) / self.std\n        hr = (self.hr[idx] - self.mean) / self.std\n        return torch.tensor(lr, dtype=torch.float32), torch.tensor(hr, dtype=torch.float32)\n"})}),"\n",(0,l.jsx)(e.h3,{id:"14-\u5b9a\u4e49\u751f\u6210\u5668",children:"1.4 \u5b9a\u4e49\u751f\u6210\u5668"}),"\n",(0,l.jsx)(e.p,{children:"\u5b9a\u4e49 cGAN \u7b49\u751f\u6210\u5668\u90e8\u5206\uff0c\u7f16\u7801\u5668\u901a\u8fc7\u4e24\u5c42\u5377\u79ef\u548c LeakyReLU \u5c06\u8f93\u5165\u56fe\u50cf\u4ece 16\xd716 \u538b\u7f29\u81f3 4\xd74\uff0c\u7528\u4e8e\u63d0\u53d6\u6df1\u5c42\u7279\u5f81\uff1b\u89e3\u7801\u5668\u5219\u901a\u8fc7\u56db\u5c42\u53cd\u5377\u79ef\uff08ConvTranspose\uff09\u9010\u6b65\u4e0a\u91c7\u6837\u56de 64\xd764\uff0c\u540c\u65f6\u4f7f\u7528 BatchNorm \u548c ReLU \u6fc0\u6d3b\u4fdd\u6301\u7a33\u5b9a\u6027\u548c\u975e\u7ebf\u6027\u8868\u8fbe\u80fd\u529b\u3002\u6700\u7ec8\u4e00\u5c42\u4f7f\u7528 Tanh \u6fc0\u6d3b\u8f93\u51fa\u9ad8\u5206\u8fa8\u7387\u56fe\u50cf"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"class GeneratorUNet(nn.Module):\n    def __init__(self, in_channels=2, out_channels=2, features=64):\n        super().__init__()\n        self.encoder = nn.Sequential(\n            nn.Conv2d(in_channels, features, 4, 2, 1),  # 16\xd716 \u2192 8\xd78\n            nn.LeakyReLU(0.2),\n            nn.Conv2d(features, features * 2, 4, 2, 1),  # 8\xd78 \u2192 4\xd74\n            nn.BatchNorm2d(features * 2),\n            nn.LeakyReLU(0.2),\n        )\n        self.decoder = nn.Sequential(\n            nn.ConvTranspose2d(features * 2, features, 4, 2, 1),  # 4\xd74 \u2192 8\xd78\n            nn.BatchNorm2d(features),\n            nn.ReLU(),\n            nn.ConvTranspose2d(features, features, 4, 2, 1),  # 8\xd78 \u2192 16\xd716\n            nn.BatchNorm2d(features),\n            nn.ReLU(),\n            nn.ConvTranspose2d(features, features, 4, 2, 1),  # 16\xd716 \u2192 32\xd732\n            nn.BatchNorm2d(features),\n            nn.ReLU(),\n            nn.ConvTranspose2d(features, out_channels, 4, 2, 1),  # 32\xd732 \u2192 64\xd764\n            nn.Tanh()\n        )\n\n    def forward(self, x):\n        return self.decoder(self.encoder(x))\n\n"})}),"\n",(0,l.jsx)(e.h3,{id:"15-\u5b9a\u4e49\u5224\u522b\u5668",children:"1.5 \u5b9a\u4e49\u5224\u522b\u5668"}),"\n",(0,l.jsx)(e.p,{children:"\u4f7f\u7528\u591a\u4e2a\u5377\u79ef\u5c42\u5bf9\u8f93\u5165\u56fe\u50cf\u5c40\u90e8\u533a\u57df\u8fdb\u884c\u771f\u5b9e\u6027\u5224\u522b\uff0c\u8f93\u5165\u4e3a\u4e0a\u91c7\u6837\u540e\u7684 LR \u56fe\u50cf\u4e0e\u771f\u5b9e/\u751f\u6210 HR \u56fe\u50cf\u7684\u62fc\u63a5\u7ed3\u679c\u3002\u7f51\u7edc\u9010\u5c42\u4e0b\u91c7\u6837\u5e76\u8f93\u51fa\u4e00\u4e2a 7\xd77 \u7684\u5224\u522b\u56fe\uff0c\u5bf9\u56fe\u50cf\u4e2d\u5404\u4e2a\u5c40\u90e8 patch \u7ed9\u51fa\u662f\u5426\u771f\u5b9e\u7684\u9884\u6d4b\u8bc4\u5206"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'import torch.nn as nn\n\nclass Discriminator(nn.Module):\n    def __init__(self, in_channels=4, features=64):\n        super().__init__()\n        self.model = nn.Sequential(\n            nn.Conv2d(in_channels, features, 4, 2, 1),  # (B, 64, 32, 32)\n            nn.LeakyReLU(0.2),\n            nn.Conv2d(features, features * 2, 4, 2, 1),  # (B, 128, 16, 16)\n            nn.BatchNorm2d(features * 2),\n            nn.LeakyReLU(0.2),\n            nn.Conv2d(features * 2, features * 4, 4, 2, 1),  # (B, 256, 8, 8)\n            nn.BatchNorm2d(features * 4),\n            nn.LeakyReLU(0.2),\n            nn.Conv2d(features * 4, 1, 4, 1, 1),  # (B, 1, 7, 7) => PatchGAN \u8f93\u51fa\n            nn.Sigmoid()\n        )\n\n    def forward(self, lr_up, hr_or_fake):\n        # Ensure both inputs are [B, 2, 64, 64]\n        if lr_up.shape[-2:] != hr_or_fake.shape[-2:]:\n            raise ValueError(f"Shape mismatch: lr_up={lr_up.shape}, hr={hr_or_fake.shape}")\n        x = torch.cat([lr_up, hr_or_fake], dim=1)  # => [B, 4, H, W]\n        return self.model(x)\n'})}),"\n",(0,l.jsx)(e.h3,{id:"16-\u8ba1\u7b97\u6307\u6807",children:"1.6 \u8ba1\u7b97\u6307\u6807"}),"\n",(0,l.jsx)(e.p,{children:"\u672c\u6587\u4ee5 SSIM\uff0cPSNR \u4e3a\u4f8b\uff0c\u5bf9\u6a21\u578b\u8fdb\u884c\u8bc4\u4f30\uff0c\u9700\u8981\u6ce8\u610f\u7684\u662f\u5f52\u4e00\u5316\u4e0d\u5e94\u8be5\u662f z-score\uff0c\u800c\u662f\u5e94\u8be5\u4f7f\u7528 max-min \u5f52\u4e00\u5316\uff08\u5403\u8fc7\u4e00\u6b21\u4e8f\uff09"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'from skimage.metrics import peak_signal_noise_ratio, structural_similarity\nimport torch.nn.functional as F\n\ndef compute_psnr_ssim(pred, target):\n    # \u8f6c\u6362\u4e3a numpy \u683c\u5f0f\uff0cshape: (N, H, W, C)\n    pred = pred.detach().cpu().numpy().transpose(0, 2, 3, 1)\n    target = target.detach().cpu().numpy().transpose(0, 2, 3, 1)\n    data_range = max(target.max(), pred.max()) - min(target.min(), pred.min())\n    psnr_total, ssim_total = 0, 0\n    for p, t in zip(pred, target):\n        psnr_total += peak_signal_noise_ratio(t, p, data_range=data_range)\n        ssim_total += structural_similarity(t, p, channel_axis=-1, data_range=data_range)\n\n    return psnr_total / len(pred), ssim_total / len(pred)\n\ndef compute_rmse(pred, target):\n    return torch.sqrt(torch.mean((pred - target) ** 2))\n\ndef compute_mae(pred, target):\n    return torch.mean(torch.abs(pred - target))\n\n# === \u6dfb\u52a0 SSIM Loss ===\ndef ssim_loss(pred, target, C1=0.01**2, C2=0.03**2):\n    mu_x = F.avg_pool2d(pred, 3, 1, 1)\n    mu_y = F.avg_pool2d(target, 3, 1, 1)\n    sigma_x = F.avg_pool2d(pred ** 2, 3, 1, 1) - mu_x ** 2\n    sigma_y = F.avg_pool2d(target ** 2, 3, 1, 1) - mu_y ** 2\n    sigma_xy = F.avg_pool2d(pred * target, 3, 1, 1) - mu_x * mu_y\n    ssim_n = (2 * mu_x * mu_y + C1) * (2 * sigma_xy + C2)\n    ssim_d = (mu_x ** 2 + mu_y ** 2 + C1) * (sigma_x + sigma_y + C2)\n    ssim_map = ssim_n / (ssim_d + 1e-8)\n    return 1 - ssim_map.mean()\n\n# \u52a0\u8f7d min/max\nhr_min = np.load("tm/min_40.npy")[:, None, None]\nhr_max = np.load("tm/max_40.npy")[:, None, None]\n\ndef minmax_scale(tensor):\n    # \u7f29\u653e\u5230 0~1\n    return (tensor - torch.tensor(hr_min, dtype=torch.float32).to(tensor.device)) / \\\n           (torch.tensor(hr_max - hr_min, dtype=torch.float32).to(tensor.device))\n'})}),"\n",(0,l.jsx)(e.h3,{id:"17-\u52a0\u8f7d\u6570\u636e\u96c6\u51c6\u5907\u8bad\u7ec3",children:"1.7 \u52a0\u8f7d\u6570\u636e\u96c6\uff0c\u51c6\u5907\u8bad\u7ec3"}),"\n",(0,l.jsx)(e.p,{children:"batch size \u4e3a\u5c06 n \u4e2a\u6837\u672c\u4e3a\u4e00\u7ec4\uff08\u4e00\u4e2a\u6279\u6b21\uff09\u8bfb\u53d6\u6570\u636e.\u5c06\u4e4b\u524d\u7684\u8bad\u7ec3\u96c6\uff0c\u6d4b\u8bd5\u96c6\u4e0e\u8bc4\u4f30\u96c6\u4e0a\u4f20\u5230\u6570\u636e\u7c7b\u5e76\u52a0\u8f7d\uff0c\u51c6\u5907\u8bad\u7ec3\u3002\u9700\u8981\u6ce8\u610f\u7684\u662f batch size \u8d8a\u5927\uff0c\u5bf9 gpu \u7684\u8d1f\u62c5\u4e5f\u8d8a\u5927\uff0c\u4f46\u662f\u540c\u65f6\u8bad\u7ec3\u5230\u7684\u6570\u636e\u4e5f\u8d8a\u591a"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'train_set = WeatherDataset(\n    "tm/LR_data_train_40.npy", "tm/HR_data_train_40.npy",\n    "tm/mean_40.npy", "tm/std_40.npy"\n)\nval_set = WeatherDataset(\n    "tm/LR_data_valid_40.npy", "tm/HR_data_valid_40.npy",\n    "tm/mean_40.npy", "tm/std_40.npy"\n)\ntest_set = WeatherDataset(\n    "tm/LR_data_test_40.npy", "tm/HR_data_test_40.npy",\n    "tm/mean_40.npy", "tm/std_40.npy"\n)\n\ntest_loader = DataLoader(test_set, batch_size=32, shuffle=False)\ntrain_loader = DataLoader(train_set, batch_size=32, shuffle=True)\nval_loader = DataLoader(val_set, batch_size=32, shuffle=False)\n'})}),"\n",(0,l.jsx)(e.h3,{id:"18-\u6a21\u578b\u8bad\u7ec3",children:"1.8 \u6a21\u578b\u8bad\u7ec3"}),"\n",(0,l.jsx)(e.p,{children:"\u9996\u5148\u5148\u5bf9\u6a21\u578b\u8fdb\u884c\u521d\u59cb\u5316\uff0c\u6700\u540e\u4e00\u53e5 print \u4e3a\u5f62\u72b6\uff0c\u5982\u679c\u5f62\u72b6\u4e0d\u5bf9\u540e\u7eed\u8bad\u7ec3\u5fc5\u5931\u8d25\u3002\u5b9e\u4f8b\u5316\u751f\u6210\u5668\u548c\u5224\u522b\u5668\u5e76\u9001\u5230\u8bbe\u5907\uff08MPS \u6216 CPU\uff09\uff1b\u63a5\u7740\u5b9a\u4e49\u635f\u5931\u51fd\u6570\uff0cMSELoss \u7528\u4e8e\u50cf\u7d20\u7ea7\u5185\u5bb9\u635f\u5931\uff0cBCELoss \u7528\u4e8e GAN \u5224\u522b\u5668\u5bf9\u6297\u635f\u5931\uff1b\u6700\u540e\u5b9a\u4e49\u4f18\u5316\u5668\uff0c\u4f7f\u7528 ADAM \u8fdb\u884c\u4f18\u5316\u5e76\u5c06\u5b66\u4e60\u7387\u8c03\u4e3a 1e-4"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'# === 6. Model Initialization ===\nG = GeneratorUNet().to(device)\nD = Discriminator().to(device)\ncriterion_GAN = nn.BCEWithLogitsLoss()\ncriterion_L1 = nn.L1Loss()\nopt_G = torch.optim.Adam(G.parameters(), lr=1e-4, betas=(0.5, 0.999), weight_decay=1e-4)\nopt_D = torch.optim.Adam(D.parameters(), lr=1e-4, betas=(0.5, 0.999), weight_decay=1e-4)\nwith torch.no_grad():\n    dummy_input = torch.randn(1, 2, 16, 16).to(device)\n    dummy_output = G(dummy_input)\n    print(f"G output shape: {dummy_output.shape}")  # \u5e94\u8be5\u662f [1, 2, 64, 64]\n'})}),"\n",(0,l.jsx)(e.p,{children:"\u51c6\u5907\u597d\u4e86\u4e4b\u540e\uff0c\u6700\u540e\u5f00\u59cb\u8fdb\u884c\u6a21\u578b\u7684\u8bad\u7ec3\u4e0e\u4fdd\u5b58\uff0c\u8bad\u7ec3\u65f6\u53ef\u4ee5\u5c06\u6bcf\u4e00\u8f6e epoch \u7684\u6307\u6807\u90fd\u4fdd\u5b58\u5728\u6570\u7ec4\u4e2d\uff0c\u65b9\u4fbf\u540e\u7eed\u753b\u56fe\uff1b\u8fd8\u9700\u8981\u6ce8\u610f\u5728\u8bad\u7ec3\u524d\u51c6\u5907\u6807\u7b7e\u6784\u9020\uff0c\u4e3a\u5bf9\u6297\u8bad\u7ec3\u51c6\u5907\u771f\u5047\u6807\u7b7e\uff08\u7528\u4e8e BCELoss\uff09\u4e14\u5224\u522b\u5668\u8f93\u51fa\u662f 6\xd76 patch \u7684\u9884\u6d4b\uff0c\u5339\u914d\u6807\u7b7e\u5f62\u72b6\u3002"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'num_epochs = 200\ntrain_psnrs, train_ssims, train_rmses, train_maes = [], [], [], []\nval_psnrs, val_ssims, val_rmses, val_maes = [], [], [], []\n\n\nfor epoch in range(num_epochs):\n    G.train()\n    for lr, hr in train_loader:\n        lr, hr = lr.to(device), hr.to(device)\n\n        # === Forward Generator ===\n        fake = G(lr).to(device)\n        lr_up = F.interpolate(lr, size=hr.shape[-2:], mode="bilinear", align_corners=False)\n\n        # === Train Discriminator ===\n        D_real = D(lr_up, hr).to(device)\n        D_fake = D(lr_up, fake.detach()).to(device)\n        loss_D = (\n            criterion_GAN(D_real, torch.ones_like(D_real)) +\n            criterion_GAN(D_fake, torch.zeros_like(D_fake))\n        ) * 0.5\n        opt_D.zero_grad()\n        loss_D.backward()\n        opt_D.step()\n\n        # === Train Generator ===\n        pred = D(lr_up, fake)\n        loss_ssim = ssim_loss(fake, hr)\n        loss_l1 = criterion_L1(fake, hr)\n        loss_gan = criterion_GAN(pred, torch.ones_like(pred))\n        loss_G = 0.01 * loss_gan + 1.0 * loss_ssim + 1.0 * loss_l1\n        opt_G.zero_grad()\n        loss_G.backward()\n        opt_G.step()\n\n\n    train_pred = G(lr)\n    train_pred = F.interpolate(train_pred, size=hr.shape[-2:], mode="bilinear", align_corners=False).to(device)\n    # \u8bc4\u4f30\n    train_pred_mm = minmax_scale(train_pred)\n    hr_mm = minmax_scale(hr)\n    psnr_train, ssim_train = compute_psnr_ssim(train_pred, hr)\n    rmse_train = compute_rmse(train_pred_mm, hr_mm)\n    mae_train = compute_mae(train_pred_mm, hr_mm)\n    # \u6dfb\u52a0\u4fdd\u5b58\n    train_psnrs.append(psnr_train)\n    train_ssims.append(ssim_train)\n    train_rmses.append(rmse_train)\n    train_maes.append(mae_train)\n\n    G.eval()\n    with torch.no_grad():\n        val_lr, val_hr = next(iter(val_loader))\n        val_lr, val_hr = val_lr.to(device), val_hr.to(device)\n        pred_hr = G(val_lr)\n        pred_hr = F.interpolate(pred_hr, size=val_hr.shape[-2:], mode="bilinear", align_corners=False).to(device)\n        # \u8ba1\u7b97\u6307\u6807\n        pred_val_mm = minmax_scale(pred_hr)\n        val_hr_mm = minmax_scale(val_hr)\n        psnr_val, ssim_val = compute_psnr_ssim(pred_hr, val_hr)\n        rmse_val = compute_rmse(pred_val_mm, val_hr_mm)\n        mae_val = compute_mae(pred_val_mm, val_hr_mm)\n        # \u6dfb\u52a0\u4fdd\u5b58\n        val_psnrs.append(psnr_val)\n        val_ssims.append(ssim_val)\n        val_rmses.append(rmse_val)\n        val_maes.append(mae_val)\n\n    # === Print summary ===\n    print(f"Epoch {epoch+1}: "\n          f"Train PSNR={psnr_train:.2f}, SSIM={ssim_train:.4f}, RMSE={rmse_train:.4f}, MAE={mae_train:.4f} | "\n          f"Valid PSNR={psnr_val:.2f}, SSIM={ssim_val:.4f}, RMSE={rmse_val:.4f}, MAE={mae_val:.4f}")\n'})}),"\n",(0,l.jsx)(e.h3,{id:"19-\u6a21\u578b\u9a8c\u8bc1",children:"1.9 \u6a21\u578b\u9a8c\u8bc1"}),"\n",(0,l.jsx)(e.p,{children:"\u8bad\u7ec3\u5b8c\u4e86\u4e4b\u540e\u5bf9\u4fdd\u5b58\u597d\u4e86\u7684\u6a21\u578b\u8fdb\u884c test \u9a8c\u8bc1\uff0c\u67e5\u770b\u8bc4\u4f30\u6307\u6807\u7684\u8868\u73b0"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'import matplotlib.pyplot as plt\nfrom torch.utils.data import DataLoader\n\n# === 1. \u52a0\u8f7d\u6d4b\u8bd5\u96c6 ===\ntest_set = WeatherDataset(\n    "tm/LR_data_test_40.npy", "tm/HR_data_test_40.npy",\n    "tm/mean_40.npy", "tm/std_40.npy"\n)\ntest_loader = DataLoader(test_set, batch_size=8, shuffle=False)\n\n# === 2. \u5728\u6d4b\u8bd5\u96c6\u4e0a\u8bc4\u4f30\u6a21\u578b ===\nG.eval()\ntest_psnrs, test_ssims, test_rmses, test_maes = [], [], [], []\nimages_to_show = []  # \u539f\u56fe\u3001\u771f\u5b9e\u56fe\u3001\u9884\u6d4b\u56fe\uff08\u53cd\u5f52\u4e00\u5316\u540e\uff09\n\n# \u53cd\u5f52\u4e00\u5316\u51fd\u6570\nmean = np.load("tm/mean_40.npy")\nstd = np.load("tm/std_40.npy")\ndef denormalize(tensor):\n    return tensor * torch.tensor(std).to(tensor.device) + torch.tensor(mean).to(tensor.device)\n\nwith torch.no_grad():\n    for test_lr, test_hr in test_loader:\n        test_lr, test_hr = test_lr.to(device), test_hr.to(device)\n        pred_test = G(test_lr)\n        pred_test = F.interpolate(pred_test, size=test_hr.shape[-2:], mode="bilinear", align_corners=False)\n\n        # \u8ba1\u7b97\u6307\u6807\uff08\u5f52\u4e00\u5316\u4e0b\uff09\n        pred_mm = minmax_scale(pred_test)\n        hr_mm = minmax_scale(test_hr)\n        psnr, ssim = compute_psnr_ssim(pred_test, test_hr)\n        rmse = compute_rmse(pred_mm, hr_mm)\n        mae = compute_mae(pred_mm, hr_mm)\n        test_psnrs.append(psnr)\n        test_ssims.append(ssim)\n        test_rmses.append(rmse.cpu().item())\n        test_maes.append(mae.cpu().item())\n\n        # \u53ef\u89c6\u5316\uff1a\u9009\u53d6\u524d1\u5f20\u56fe\uff0c\u53cd\u5f52\u4e00\u5316\n        for i in range(1):\n            lr_img = F.interpolate(test_lr[i:i+1], size=(64, 64), mode="bilinear", align_corners=False)\n            images_to_show.append((\n                denormalize(lr_img[0].cpu()),\n                denormalize(test_hr[i].cpu()),\n                denormalize(pred_test[i].cpu())\n            ))\n\n# === 3. \u6253\u5370\u6d4b\u8bd5\u96c6\u5e73\u5747\u6307\u6807 ===\nprint(f"Test Set Evaluation cGAN Winter:")\nprint(f"PSNR: {np.mean(test_psnrs):.2f}")\nprint(f"SSIM: {np.mean(test_ssims):.4f}")\nprint(f"RMSE: {np.mean(test_rmses):.4f}")\nprint(f"MAE: {np.mean(test_maes):.4f}")\n'})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"\u5e38\u7528\u6307\u6807\u8ba1\u7b97\u516c\u5f0f"})}),"\n",(0,l.jsxs)(e.ol,{children:["\n",(0,l.jsx)(e.li,{children:"PSNR\uff08\u5cf0\u503c\u4fe1\u566a\u6bd4\uff09"}),"\n"]}),"\n",(0,l.jsx)(e.span,{className:"katex-display",children:(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mtext,{children:"PSNR"}),(0,l.jsx)(e.mo,{children:"="}),(0,l.jsx)(e.mn,{children:"10"}),(0,l.jsx)(e.mo,{children:"\u22c5"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"log"}),(0,l.jsx)(e.mo,{children:"\u2061"})]}),(0,l.jsx)(e.mn,{children:"10"})]}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{fence:"true",children:"("}),(0,l.jsxs)(e.mfrac,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"M"}),(0,l.jsx)(e.mi,{children:"A"}),(0,l.jsxs)(e.msup,{children:[(0,l.jsx)(e.mi,{children:"X"}),(0,l.jsx)(e.mn,{children:"2"})]})]}),(0,l.jsx)(e.mtext,{children:"MSE"})]}),(0,l.jsx)(e.mo,{fence:"true",children:")"})]})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{PSNR} = 10 \\cdot \\log_{10} \\left( \\frac{MAX^2}{\\text{MSE}} \\right)\n"})]})})}),(0,l.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord text",children:(0,l.jsx)(e.span,{className:"mord",children:"PSNR"})}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(e.span,{className:"mrel",children:"="}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6444em"}}),(0,l.jsx)(e.span,{className:"mord",children:"10"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\u22c5"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"2.4411em",verticalAlign:"-0.95em"}}),(0,l.jsxs)(e.span,{className:"mop",children:[(0,l.jsxs)(e.span,{className:"mop",children:["lo",(0,l.jsx)(e.span,{style:{marginRight:"0.01389em"},children:"g"})]}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.207em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.4559em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"10"})})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.2441em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsxs)(e.span,{className:"minner",children:[(0,l.jsx)(e.span,{className:"mopen delimcenter",style:{top:"0em"},children:(0,l.jsx)(e.span,{className:"delimsizing size3",children:"("})}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(e.span,{className:"mfrac",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"1.4911em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"mord",children:(0,l.jsx)(e.span,{className:"mord text",children:(0,l.jsx)(e.span,{className:"mord",children:"MSE"})})})]}),(0,l.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.10903em"},children:"M"}),(0,l.jsx)(e.span,{className:"mord mathnormal",children:"A"}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07847em"},children:"X"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsx)(e.span,{className:"vlist-t",children:(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.8141em"},children:(0,l.jsxs)(e.span,{style:{top:"-3.063em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]})]})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,l.jsx)(e.span,{className:"mclose delimcenter",style:{top:"0em"},children:(0,l.jsx)(e.span,{className:"delimsizing size3",children:")"})})]})]})]})]})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsxs)(e.ol,{start:"2",children:["\n",(0,l.jsx)(e.li,{children:"SSIM\uff08\u7ed3\u6784\u76f8\u4f3c\u6027\uff09"}),"\n"]}),"\n",(0,l.jsx)(e.span,{className:"katex-display",children:(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mtext,{children:"SSIM"}),(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mo,{separator:"true",children:","}),(0,l.jsx)(e.mi,{children:"y"}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"}),(0,l.jsx)(e.mo,{children:"="}),(0,l.jsxs)(e.mfrac,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsx)(e.mn,{children:"2"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"\u03bc"}),(0,l.jsx)(e.mi,{children:"x"})]}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"\u03bc"}),(0,l.jsx)(e.mi,{children:"y"})]}),(0,l.jsx)(e.mo,{children:"+"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"C"}),(0,l.jsx)(e.mn,{children:"1"})]}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"}),(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsx)(e.mn,{children:"2"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"\u03c3"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mi,{children:"y"})]})]}),(0,l.jsx)(e.mo,{children:"+"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"C"}),(0,l.jsx)(e.mn,{children:"2"})]}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"})]}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsxs)(e.msubsup,{children:[(0,l.jsx)(e.mi,{children:"\u03bc"}),(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mn,{children:"2"})]}),(0,l.jsx)(e.mo,{children:"+"}),(0,l.jsxs)(e.msubsup,{children:[(0,l.jsx)(e.mi,{children:"\u03bc"}),(0,l.jsx)(e.mi,{children:"y"}),(0,l.jsx)(e.mn,{children:"2"})]}),(0,l.jsx)(e.mo,{children:"+"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"C"}),(0,l.jsx)(e.mn,{children:"1"})]}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"}),(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsxs)(e.msubsup,{children:[(0,l.jsx)(e.mi,{children:"\u03c3"}),(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mn,{children:"2"})]}),(0,l.jsx)(e.mo,{children:"+"}),(0,l.jsxs)(e.msubsup,{children:[(0,l.jsx)(e.mi,{children:"\u03c3"}),(0,l.jsx)(e.mi,{children:"y"}),(0,l.jsx)(e.mn,{children:"2"})]}),(0,l.jsx)(e.mo,{children:"+"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"C"}),(0,l.jsx)(e.mn,{children:"2"})]}),(0,l.jsx)(e.mo,{stretchy:"false",children:")"})]})]})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{SSIM}(x, y) = \\frac{(2\\mu_x \\mu_y + C_1)(2\\sigma_{xy} + C_2)}{(\\mu_x^2 + \\mu_y^2 + C_1)(\\sigma_x^2 + \\sigma_y^2 + C_2)}\n"})]})})}),(0,l.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsx)(e.span,{className:"mord text",children:(0,l.jsx)(e.span,{className:"mord",children:"SSIM"})}),(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,l.jsx)(e.span,{className:"mpunct",children:","}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,l.jsx)(e.span,{className:"mclose",children:")"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(e.span,{className:"mrel",children:"="}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"2.4961em",verticalAlign:"-1.0691em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(e.span,{className:"mfrac",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"1.427em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"\u03bc"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"0.7401em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"})})]}),(0,l.jsxs)(e.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.247em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"+"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"\u03bc"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"0.7401em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})})]}),(0,l.jsxs)(e.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"+"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"1"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mclose",children:")"}),(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c3"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"0.7401em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"})})]}),(0,l.jsxs)(e.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.247em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"+"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c3"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"0.7401em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.453em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})})]}),(0,l.jsxs)(e.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3831em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"+"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mclose",children:")"})]})]}),(0,l.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsx)(e.span,{className:"mord",children:"2"}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"\u03bc"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"\u03bc"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"+"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"1"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mclose",children:")"}),(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsx)(e.span,{className:"mord",children:"2"}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"\u03c3"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.1514em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"x"}),(0,l.jsx)(e.span,{className:"mord mathnormal mtight",style:{marginRight:"0.03588em"},children:"y"})]})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.2861em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"+"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.07153em"},children:"C"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3011em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0715em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mclose",children:")"})]})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"1.0691em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mclose nulldelimiter"})]})]})]})]})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsxs)(e.ol,{start:"3",children:["\n",(0,l.jsx)(e.li,{children:"RMSE\uff08\u5747\u65b9\u6839\u8bef\u5dee\uff09"}),"\n"]}),"\n",(0,l.jsx)(e.span,{className:"katex-display",children:(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mtext,{children:"RMSE"}),(0,l.jsx)(e.mo,{children:"="}),(0,l.jsx)(e.msqrt,{children:(0,l.jsxs)(e.mrow,{children:[(0,l.jsxs)(e.mfrac,{children:[(0,l.jsx)(e.mn,{children:"1"}),(0,l.jsx)(e.mi,{children:"n"})]}),(0,l.jsxs)(e.munderover,{children:[(0,l.jsx)(e.mo,{children:"\u2211"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"i"}),(0,l.jsx)(e.mo,{children:"="}),(0,l.jsx)(e.mn,{children:"1"})]}),(0,l.jsx)(e.mi,{children:"n"})]}),(0,l.jsx)(e.mo,{stretchy:"false",children:"("}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mi,{children:"i"})]}),(0,l.jsx)(e.mo,{children:"\u2212"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"y"}),(0,l.jsx)(e.mi,{children:"i"})]}),(0,l.jsxs)(e.msup,{children:[(0,l.jsx)(e.mo,{stretchy:"false",children:")"}),(0,l.jsx)(e.mn,{children:"2"})]})]})})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{RMSE} = \\sqrt{\\frac{1}{n} \\sum_{i=1}^{n} (x_i - y_i)^2}\n"})]})})}),(0,l.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord text",children:(0,l.jsx)(e.span,{className:"mord",children:"RMSE"})}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(e.span,{className:"mrel",children:"="}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"3.1568em",verticalAlign:"-1.2777em"}}),(0,l.jsx)(e.span,{className:"mord sqrt",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"1.8791em"},children:[(0,l.jsxs)(e.span,{className:"svg-align",style:{top:"-5.1168em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"5.1168em"}}),(0,l.jsxs)(e.span,{className:"mord",style:{paddingLeft:"1.056em"},children:[(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(e.span,{className:"mfrac",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"mord",children:(0,l.jsx)(e.span,{className:"mord mathnormal",children:"n"})})]}),(0,l.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"mord",children:(0,l.jsx)(e.span,{className:"mord",children:"1"})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(e.span,{className:"mop op-limits",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"1.6514em"},children:[(0,l.jsxs)(e.span,{style:{top:"-1.8723em",marginLeft:"0em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,l.jsx)(e.span,{className:"mrel mtight",children:"="}),(0,l.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]}),(0,l.jsxs)(e.span,{style:{top:"-3.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,l.jsx)(e.span,{children:(0,l.jsx)(e.span,{className:"mop op-symbol large-op",children:"\u2211"})})]}),(0,l.jsxs)(e.span,{style:{top:"-4.3em",marginLeft:"0em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"n"})})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"1.2777em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mopen",children:"("}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsxs)(e.span,{className:"mclose",children:[(0,l.jsx)(e.span,{className:"mclose",children:")"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsx)(e.span,{className:"vlist-t",children:(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.7401em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.989em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:"2"})})]})})})})})]})]})]}),(0,l.jsxs)(e.span,{style:{top:"-3.8391em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"5.1168em"}}),(0,l.jsx)(e.span,{className:"hide-tail",style:{minWidth:"0.742em",height:"3.1968em"},children:(0,l.jsx)(e.svg,{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"3.1968em",viewBox:"0 0 400000 3196",preserveAspectRatio:"xMinYMin slice",children:(0,l.jsx)(e.path,{d:"M702 80H40000040\nH742v3062l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1\nh-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170\nc-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667\n219 661 l218 661zM702 80H400000v40H742z"})})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"1.2777em"},children:(0,l.jsx)(e.span,{})})})]})})]})]})]})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsxs)(e.ol,{start:"4",children:["\n",(0,l.jsx)(e.li,{children:"MAE\uff08\u5e73\u5747\u7edd\u5bf9\u8bef\u5dee\uff09"}),"\n"]}),"\n",(0,l.jsx)(e.span,{className:"katex-display",children:(0,l.jsxs)(e.span,{className:"katex",children:[(0,l.jsx)(e.span,{className:"katex-mathml",children:(0,l.jsx)(e.math,{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block",children:(0,l.jsxs)(e.semantics,{children:[(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mtext,{children:"MAE"}),(0,l.jsx)(e.mo,{children:"="}),(0,l.jsxs)(e.mfrac,{children:[(0,l.jsx)(e.mn,{children:"1"}),(0,l.jsx)(e.mi,{children:"n"})]}),(0,l.jsxs)(e.munderover,{children:[(0,l.jsx)(e.mo,{children:"\u2211"}),(0,l.jsxs)(e.mrow,{children:[(0,l.jsx)(e.mi,{children:"i"}),(0,l.jsx)(e.mo,{children:"="}),(0,l.jsx)(e.mn,{children:"1"})]}),(0,l.jsx)(e.mi,{children:"n"})]}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"x"}),(0,l.jsx)(e.mi,{children:"i"})]}),(0,l.jsx)(e.mo,{children:"\u2212"}),(0,l.jsxs)(e.msub,{children:[(0,l.jsx)(e.mi,{children:"y"}),(0,l.jsx)(e.mi,{children:"i"})]}),(0,l.jsx)(e.mi,{mathvariant:"normal",children:"\u2223"})]}),(0,l.jsx)(e.annotation,{encoding:"application/x-tex",children:"\\text{MAE} = \\frac{1}{n} \\sum_{i=1}^{n} |x_i - y_i|\n"})]})})}),(0,l.jsxs)(e.span,{className:"katex-html","aria-hidden":"true",children:[(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"0.6833em"}}),(0,l.jsx)(e.span,{className:"mord text",children:(0,l.jsx)(e.span,{className:"mord",children:"MAE"})}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}}),(0,l.jsx)(e.span,{className:"mrel",children:"="}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2778em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"2.9291em",verticalAlign:"-1.2777em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mopen nulldelimiter"}),(0,l.jsx)(e.span,{className:"mfrac",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"1.3214em"},children:[(0,l.jsxs)(e.span,{style:{top:"-2.314em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"mord",children:(0,l.jsx)(e.span,{className:"mord mathnormal",children:"n"})})]}),(0,l.jsxs)(e.span,{style:{top:"-3.23em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"frac-line",style:{borderBottomWidth:"0.04em"}})]}),(0,l.jsxs)(e.span,{style:{top:"-3.677em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3em"}}),(0,l.jsx)(e.span,{className:"mord",children:(0,l.jsx)(e.span,{className:"mord",children:"1"})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.686em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mclose nulldelimiter"})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(e.span,{className:"mop op-limits",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsxs)(e.span,{className:"vlist",style:{height:"1.6514em"},children:[(0,l.jsxs)(e.span,{style:{top:"-1.8723em",marginLeft:"0em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsxs)(e.span,{className:"mord mtight",children:[(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"}),(0,l.jsx)(e.span,{className:"mrel mtight",children:"="}),(0,l.jsx)(e.span,{className:"mord mtight",children:"1"})]})})]}),(0,l.jsxs)(e.span,{style:{top:"-3.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,l.jsx)(e.span,{children:(0,l.jsx)(e.span,{className:"mop op-symbol large-op",children:"\u2211"})})]}),(0,l.jsxs)(e.span,{style:{top:"-4.3em",marginLeft:"0em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"3.05em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"n"})})})]})]}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"1.2777em"},children:(0,l.jsx)(e.span,{})})})]})}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,l.jsx)(e.span,{className:"mord",children:"\u2223"}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",children:"x"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"0em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,l.jsx)(e.span,{className:"mbin",children:"\u2212"}),(0,l.jsx)(e.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,l.jsxs)(e.span,{className:"base",children:[(0,l.jsx)(e.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,l.jsxs)(e.span,{className:"mord",children:[(0,l.jsx)(e.span,{className:"mord mathnormal",style:{marginRight:"0.03588em"},children:"y"}),(0,l.jsx)(e.span,{className:"msupsub",children:(0,l.jsxs)(e.span,{className:"vlist-t vlist-t2",children:[(0,l.jsxs)(e.span,{className:"vlist-r",children:[(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.3117em"},children:(0,l.jsxs)(e.span,{style:{top:"-2.55em",marginLeft:"-0.0359em",marginRight:"0.05em"},children:[(0,l.jsx)(e.span,{className:"pstrut",style:{height:"2.7em"}}),(0,l.jsx)(e.span,{className:"sizing reset-size6 size3 mtight",children:(0,l.jsx)(e.span,{className:"mord mathnormal mtight",children:"i"})})]})}),(0,l.jsx)(e.span,{className:"vlist-s",children:"\u200b"})]}),(0,l.jsx)(e.span,{className:"vlist-r",children:(0,l.jsx)(e.span,{className:"vlist",style:{height:"0.15em"},children:(0,l.jsx)(e.span,{})})})]})})]}),(0,l.jsx)(e.span,{className:"mord",children:"\u2223"})]})]})]})}),"\n",(0,l.jsx)(e.h3,{id:"110-\u4fdd\u5b58",children:"1.10 \u4fdd\u5b58"}),"\n",(0,l.jsx)(e.p,{children:"\u8fd9\u90e8\u5206\u5c31\u4e0d\u591a\u8bf4\u4e86\uff0c\u63d0\u4f9b\u4e00\u4e0b\u8bc4\u4f30\u6307\u6807\u7684\u4fdd\u5b58\u65b9\u5f0f\uff0c\u63a5\u7740\u60f3\u53ef\u89c6\u5316\u7b49\u7b49\u7686\u53ef"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'# \u5c06\u6570\u7ec4\u4fdd\u5b58\u4e3a .npy \u6587\u4ef6\nnp.save("1_ssim_train.npy", train_ssims)\nnp.save("1_psnr_train.npy", train_psnrs)\nnp.save("1_ssim_valid.npy", val_ssims)\nnp.save("1_psnr_valid.npy", val_psnrs)\n\nprint("\u2705 \u5df2\u4fdd\u5b58\u4e3a 1_ssim_train.npy, 1_psnr_train.npy, 1_ssim_valid.npy, 1_psnr_valid.npy")\n\n# \u786e\u4fdd\u6bcf\u4e2a tensor \u90fd\u901a\u8fc7 .detach() \u65ad\u5f00\u8ba1\u7b97\u56fe\uff0c\u4e4b\u540e\u8f6c\u79fb\u5230 CPU \u5e76\u8f6c\u6362\u4e3a NumPy \u6570\u7ec4\ntrain_maes_cpu = [mae.detach().cpu().numpy() for mae in train_maes]\ntrain_rmses_cpu = [rmse.detach().cpu().numpy() for rmse in train_rmses]\nvalid_maes_cpu = [mae.detach().cpu().numpy() for mae in val_maes]\nvalid_rmses_cpu = [rmse.detach().cpu().numpy() for rmse in val_rmses]\n\n# \u4fdd\u5b58\u4e3a .npy \u6587\u4ef6\nnp.save("1_mae_train.npy", train_maes_cpu)\nnp.save("1_rmes_train.npy", train_rmses_cpu)\nnp.save("1_mae_valid.npy", valid_maes_cpu)\nnp.save("1_rmes_valid.npy", valid_rmses_cpu)\n\n# .npy \u6587\u4ef6\u7684\u5217\u8868\nfiles = [\n    "1_mae_train.npy", "1_mae_valid.npy",\n    "1_psnr_train.npy", "1_psnr_valid.npy",\n    "1_rmes_train.npy", "1_rmes_valid.npy",\n    "1_ssim_train.npy", "1_ssim_valid.npy"\n]\n\n# \u521b\u5efa\u4e00\u4e2a\u5b57\u5178\u6765\u5b58\u50a8\u6570\u636e\ndata_dict = {}\n\n# \u52a0\u8f7d\u6bcf\u4e2a .npy \u6587\u4ef6\u5e76\u5b58\u5165\u5b57\u5178\nfor file in files:\n    data_dict[file] = np.load(file)\n\n# \u5c06\u5b57\u5178\u8f6c\u6362\u4e3a pandas DataFrame\ndf = pd.DataFrame(data_dict)\n\n# \u5c06 DataFrame \u4fdd\u5b58\u4e3a CSV \u6587\u4ef6\ndf.to_csv("cGAN_data_Winter.csv", index=False)\n'})}),"\n",(0,l.jsx)(e.h2,{id:"2-srgan",children:"2. SRGAN"}),"\n",(0,l.jsx)(e.p,{children:"\u5927\u90e8\u5206\u53ef\u7c7b\u6bd4\u8fc7\u6765\uff0c\u5177\u4f53\u5c31\u53bb\u770b\u539f\u4ee3\u7801\uff0c\u8fd9\u91cc\u5c31\u8bb2\u4e00\u4e9b\u4e0d\u4e00\u6837\u7684\u90e8\u5206\uff0c\u6bd4\u5982\u8bf4\u751f\u6210\u5668\u4e0e\u5224\u522b\u5668"}),"\n",(0,l.jsx)(e.h3,{id:"21-\u751f\u6210\u5668\u6a21\u578b-srresnetgenerator",children:"2.1 \u751f\u6210\u5668\u6a21\u578b SRResNetGenerator"}),"\n",(0,l.jsx)(e.p,{children:"\u8be5\u7f51\u7edc\u57fa\u672c\u7ed3\u6784\u6a21\u4eff SRResNet\uff0c\u5185\u542b\uff1a\n\xb7 Initial Layer\uff1a9x9 \u5927\u5377\u79ef\u6838 + PReLU\n\xb7 8 \u4e2a\u6b8b\u5dee\u5757\uff08\u6bcf\u5757\u5e26\u6709\u4e24\u5c42\u5377\u79ef + BN + PReLU\uff09\n\xb7 \u6b8b\u5dee\u8fde\u63a5\uff08ResNet \u98ce\u683c\uff09\n\u4e0a\u91c7\u6837\u5c42\uff1a\n\xb7 \u4f7f\u7528 PixelShuffle \u5b9e\u73b0\u56fe\u50cf\u4e0a\u91c7\u6837\uff08\u4ece 16x16 \u2192 64x64\uff09\n\xb7 \u6700\u7ec8\u5377\u79ef + Tanh\uff1a\u8f93\u51fa\u8303\u56f4\u89c4\u8303\u4e3a [-1, 1]"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"class SRResNetGenerator(nn.Module):\n    def __init__(self, in_channels=2, out_channels=2, features=64):\n        super().__init__()\n        self.initial = nn.Sequential(\n            nn.Conv2d(in_channels, features, kernel_size=9, padding=4),\n            nn.PReLU()\n        )\n\n        # 8 Residual Blocks\n        res_blocks = []\n        for _ in range(8):\n            res_blocks.append(nn.Sequential(\n                nn.Conv2d(features, features, kernel_size=3, padding=1),\n                nn.BatchNorm2d(features),\n                nn.PReLU(),\n                nn.Conv2d(features, features, kernel_size=3, padding=1),\n                nn.BatchNorm2d(features)\n            ))\n        self.res_blocks = nn.Sequential(*res_blocks)\n\n        self.mid_conv = nn.Sequential(\n            nn.Conv2d(features, features, kernel_size=3, padding=1),\n            nn.BatchNorm2d(features)\n        )\n\n        self.upsample = nn.Sequential(\n            nn.Conv2d(features, features * 4, 3, 1, 1),\n            nn.PixelShuffle(2),\n            nn.PReLU(),\n            nn.Conv2d(features, features * 4, 3, 1, 1),\n            nn.PixelShuffle(2),\n            nn.PReLU(),\n        )\n\n        self.final = nn.Sequential(\n            nn.Conv2d(features, out_channels, kernel_size=9, padding=4),\n            nn.Tanh()\n        )\n\n    def forward(self, x):\n        x1 = self.initial(x)\n        res = x1\n        for block in self.res_blocks:\n            res = res + block(res)\n        out = self.mid_conv(res)\n        out = out + x1\n        out = self.upsample(out)\n        return self.final(out)\n"})}),"\n",(0,l.jsx)(e.h3,{id:"22-\u5b9a\u4e49\u5224\u522b\u5668-discriminator",children:"2.2 \u5b9a\u4e49\u5224\u522b\u5668 Discriminator"}),"\n",(0,l.jsx)(e.p,{children:"\u8be5\u5224\u522b\u5668\u7528\u4e8e\u5224\u65ad\u8f93\u5165\u56fe\u50cf\u662f\u5426\u4e3a\u771f\u5b9e\u9ad8\u5206\u56fe\u50cf\uff0c\u5177\u4f53\u5982\u4e0b\uff1a\n\xb7 \u591a\u5c42\u5377\u79ef+BN+LeakyReLU\uff0c\u6700\u540e\u8f93\u51fa\u4e3a\u4e00\u4e2a\u503c\n\xb7 \u7c7b\u4f3c PatchGAN \u98ce\u683c\uff08\u7ed3\u679c\u4e3a\u4e8c\u7ef4\u7279\u5f81\u56fe\uff09\n\xb7 \u6700\u540e\u4e00\u5c42\u91c7\u7528 Sigmoid \u6fc0\u6d3b\uff0c\u8f93\u51fa\u6982\u7387"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'import torch.nn as nn\n\nclass Discriminator(nn.Module):\n    def __init__(self, in_channels=4, features=64):\n        super().__init__()\n        self.model = nn.Sequential(\n            nn.Conv2d(in_channels, features, 4, 2, 1),  # (B, 64, 32, 32)\n            nn.LeakyReLU(0.2),\n            nn.Conv2d(features, features * 2, 4, 2, 1),  # (B, 128, 16, 16)\n            nn.BatchNorm2d(features * 2),\n            nn.LeakyReLU(0.2),\n            nn.Conv2d(features * 2, features * 4, 4, 2, 1),  # (B, 256, 8, 8)\n            nn.BatchNorm2d(features * 4),\n            nn.LeakyReLU(0.2),\n            nn.Conv2d(features * 4, 1, 4, 1, 1),  # (B, 1, 7, 7) => PatchGAN \u8f93\u51fa\n            nn.Sigmoid()\n        )\n\n    def forward(self, lr_up, hr_or_fake):\n        # \u786e\u4fdd\u4e3a[B, 2, 64, 64]\n        if lr_up.shape[-2:] != hr_or_fake.shape[-2:]:\n            raise ValueError(f"Shape mismatch: lr_up={lr_up.shape}, hr={hr_or_fake.shape}")\n        x = torch.cat([lr_up, hr_or_fake], dim=1)  # [B, 4, H, W]\n        return self.model(x)\n'})}),"\n",(0,l.jsx)(e.h2,{id:"3-esrgan",children:"3. ESRGAN"}),"\n",(0,l.jsx)(e.h3,{id:"31-\u751f\u6210\u5668\u6a21\u578b-rdbnet",children:"3.1 \u751f\u6210\u5668\u6a21\u578b RDBNet"}),"\n",(0,l.jsx)(e.p,{children:"\u4f7f\u7528\u591a\u4e2a \u6b8b\u5dee\u5bc6\u96c6\u5757\uff08RRDB\uff09\uff0c\u7528\u4e8e\u6df1\u5c42\u6b21\u7279\u5f81\u63d0\u53d6\u4e0e\u7a33\u5b9a\u8bad\u7ec3\uff1b\u6bcf\u4e2a RRDB \u7531\u4e09\u4e2a\u53bb BN \u7684 DenseBlock \u7ec4\u6210\uff0c\u901a\u8fc7\u5c40\u90e8\u548c\u5168\u5c40\u6b8b\u5dee\u8fde\u63a5\u589e\u5f3a\u68af\u5ea6\u4f20\u64ad\u3001\u6291\u5236\u4fe1\u606f\u4e22\u5931\u3002\u6574\u4f53\u6d41\u7a0b\u4e3a\uff1a\u8f93\u5165\u56fe\u50cf\u7ecf\u5377\u79ef\u63d0\u53d6\u521d\u6b65\u7279\u5f81 \u2192 \u591a\u5c42 RRDB \u63d0\u53d6\u6df1\u5c42\u8868\u793a \u2192 \u4e0a\u91c7\u6837\u6a21\u5757\u9010\u6b65\u6062\u590d\u7a7a\u95f4\u5206\u8fa8\u7387 \u2192 \u6700\u7ec8\u8f93\u51fa"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"import torch\nimport torch.nn as nn\n\n# Dense Block\uff08\u53bb\u6389BN + \u6b8b\u5dee\u7f29\u653e\uff09\nclass DenseBlock(nn.Module):\n    def __init__(self, channels=64, growth_channels=32):\n        super().__init__()\n        self.layers = nn.ModuleList()\n        for i in range(5):\n            self.layers.append(nn.Conv2d(channels + i * growth_channels, growth_channels, 3, 1, 1))\n        self.lrelu = nn.LeakyReLU(0.2, inplace=True)\n        self.conv_last = nn.Conv2d(channels + 5 * growth_channels, channels, 3, 1, 1)\n\n    def forward(self, x):\n        inputs = [x]\n        for conv in self.layers:\n            out = self.lrelu(conv(torch.cat(inputs, dim=1)))\n            inputs.append(out)\n        out = self.conv_last(torch.cat(inputs, dim=1))\n        return x + out * 0.2  # Local residual\n\n# RRDB\nclass RRDB(nn.Module):\n    def __init__(self, channels, growth_channels=32):\n        super().__init__()\n        self.block1 = DenseBlock(channels, growth_channels)\n        self.block2 = DenseBlock(channels, growth_channels)\n        self.block3 = DenseBlock(channels, growth_channels)\n\n    def forward(self, x):\n        out = self.block1(x)\n        out = self.block2(out)\n        out = self.block3(out)\n        return x + out * 0.2  # Global residual\n\n# ESRGAN Generator (RRDBNet)\nclass RRDBNet(nn.Module):\n    def __init__(self, in_channels=2, out_channels=2, features=64, num_blocks=8):\n        super().__init__()\n        self.conv_first = nn.Conv2d(in_channels, features, 3, 1, 1)\n\n        # RRDB trunk\n        self.rrdb_blocks = nn.Sequential(*[RRDB(features) for _ in range(num_blocks)])\n        self.trunk_conv = nn.Conv2d(features, features, 3, 1, 1)\n\n        # Upsampling blocks\n        self.upsample = nn.Sequential(\n            nn.Conv2d(features, features * 4, 3, 1, 1),\n            nn.PixelShuffle(2),\n            nn.LeakyReLU(0.2, inplace=True),\n            nn.Conv2d(features, features * 4, 3, 1, 1),\n            nn.PixelShuffle(2),\n            nn.LeakyReLU(0.2, inplace=True)\n        )\n\n        self.conv_last = nn.Conv2d(features, out_channels, 3, 1, 1)\n\n    def forward(self, x):\n        fea = self.conv_first(x)\n        trunk = self.trunk_conv(self.rrdb_blocks(fea))\n        fea = fea + trunk\n        out = self.upsample(fea)\n        out = self.conv_last(out)\n        return out\n\n"})}),"\n",(0,l.jsx)(e.h3,{id:"32-\u5224\u522b\u5668\u6a21\u578b-esrdiscriminator",children:"3.2 \u5224\u522b\u5668\u6a21\u578b ESRDiscriminator"}),"\n",(0,l.jsx)(e.p,{children:"ESRDiscriminator \u662f\u4e00\u4e2a\u6df1\u5c42 PatchGAN \u5224\u522b\u5668\uff0c\u901a\u8fc7\u9010\u5c42\u5377\u79ef\u4e0b\u91c7\u6837\u63d0\u53d6\u56fe\u50cf\u5c40\u90e8\u7279\u5f81\uff0c\u5e76\u5bf9 LR \u56fe\u50cf\u4e0e HR \u56fe\u50cf\u7684\u62fc\u63a5\u8f93\u5165\u8fdb\u884c\u771f\u5047\u5224\u522b"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:'class ESRDiscriminator(nn.Module):\n    def __init__(self, in_channels=4, base_features=64):\n        super().__init__()\n        def block(in_f, out_f, stride):\n            return nn.Sequential(\n                nn.Conv2d(in_f, out_f, 3, stride, 1),\n                nn.LeakyReLU(0.2, inplace=True)\n            )\n\n        layers = [\n            block(in_channels, base_features, 1),\n            block(base_features, base_features, 2),\n            block(base_features, base_features * 2, 1),\n            block(base_features * 2, base_features * 2, 2),\n            block(base_features * 2, base_features * 4, 1),\n            block(base_features * 4, base_features * 4, 2),\n            block(base_features * 4, base_features * 8, 1),\n            block(base_features * 8, base_features * 8, 2),\n            nn.Conv2d(base_features * 8, 1, 3, 1, 1)  # PatchGAN \u8f93\u51fa\n        ]\n        self.model = nn.Sequential(*layers)\n\n    def forward(self, lr_up, hr_or_fake):\n        if lr_up.shape[-2:] != hr_or_fake.shape[-2:]:\n            raise ValueError(f"Shape mismatch: lr_up={lr_up.shape}, hr={hr_or_fake.shape}")\n        x = torch.cat([lr_up, hr_or_fake], dim=1)  # \u62fc\u63a5\u8f93\u5165 [B, 4, H, W]\n        return self.model(x)\n'})}),"\n",(0,l.jsx)(e.h1,{id:"srgan-\u53ca\u5176\u6d88\u878d\u8bd5\u9a8c",children:"SRGAN \u53ca\u5176\u6d88\u878d\u8bd5\u9a8c"}),"\n",(0,l.jsx)(e.p,{children:"\u4ee5 SRGAN \u4e3a baseline\uff0c\u672c\u6587\u5bf9\u6bd4\u4e86\u56db\u79cd\u60c5\u51b5\uff0c\u5373"}),"\n",(0,l.jsx)(e.h2,{id:"1-\u635f\u5931\u51fd\u6570\u6539\u8fdb\u7248",children:"1. \u635f\u5931\u51fd\u6570\u6539\u8fdb\u7248"}),"\n",(0,l.jsx)(e.p,{children:"\u9664\u4e86\u4f7f\u7528\u4f20\u7edf\u7684 MSE \u548c\u5bf9\u6297\u635f\u5931\uff0c\u8fd8\u4f7f\u7528\u4e86 VGG perceptual loss\uff08\u57fa\u4e8e VGG \u7f51\u7edc\u7684\u4e2d\u95f4\u5c42\uff09\uff1bMS-SSIM\uff08\u591a\u5c3a\u5ea6\u7ed3\u6784\u76f8\u4f3c\u6027\u6307\u6807\uff09"}),"\n",(0,l.jsx)(e.h2,{id:"2-\u901a\u9053\u6ce8\u610f\u529b\u673a\u5236\u7248",children:"2. \u901a\u9053\u6ce8\u610f\u529b\u673a\u5236\u7248"}),"\n",(0,l.jsx)(e.p,{children:"\u5728\u751f\u6210\u5668\u7684\u6b8b\u5dee\u5757\u6216\u7279\u5f81\u878d\u5408\u6a21\u5757\u4e2d\u5f15\u5165 Channel Attention \u6a21\u5757\uff0c\u540c\u65f6\u5f15\u5165 Squeeze-and-Excitation\uff08SE\uff09\u901a\u9053\u6ce8\u610f\u529b\u6a21\u5757\uff0c\u5e76\u5728\u6bcf\u4e2a\u6b8b\u5dee\u5757\u4e4b\u540e\u63d2\u5165 SEBlock(features)"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"class SEBlock(nn.Module):\n    def __init__(self, channel, reduction=16):\n        super(SEBlock, self).__init__()\n        self.avg_pool = nn.AdaptiveAvgPool2d(1)\n        self.fc1 = nn.Conv2d(channel, channel // reduction, 1, bias=False)\n        self.relu = nn.ReLU(inplace=True)\n        self.fc2 = nn.Conv2d(channel // reduction, channel, 1, bias=False)\n        self.sigmoid = nn.Sigmoid()\n\n    def forward(self, x):\n        # Squeeze: Global Average Pooling\n        y = self.avg_pool(x)\n        # Excitation: Fully connected layers\n        y = self.fc1(y)\n        y = self.relu(y)\n        y = self.fc2(y)\n        y = self.sigmoid(y)\n        return x * y\n\n\n\n\nclass SRResNetGenerator(nn.Module):\n    def __init__(self, in_channels=2, out_channels=2, features=64):\n        super(SRResNetGenerator, self).__init__()\n        self.initial = nn.Sequential(\n            nn.Conv2d(in_channels, features, kernel_size=9, padding=4),\n            nn.PReLU()\n        )\n\n        # 8 Residual Blocks with SE Blocks\n        res_blocks = []\n        for _ in range(8):\n            res_blocks.append(nn.Sequential(\n                nn.Conv2d(features, features, kernel_size=3, padding=1),\n                nn.BatchNorm2d(features),\n                nn.PReLU(),\n                nn.Conv2d(features, features, kernel_size=3, padding=1),\n                nn.BatchNorm2d(features),\n                SEBlock(features)  # Add SE Block after each residual block\n            ))\n        self.res_blocks = nn.Sequential(*res_blocks)\n\n        self.mid_conv = nn.Sequential(\n            nn.Conv2d(features, features, kernel_size=3, padding=1),\n            nn.BatchNorm2d(features)\n        )\n\n        self.upsample = nn.Sequential(\n            nn.Conv2d(features, features * 4, 3, 1, 1),\n            nn.PixelShuffle(2),\n            nn.PReLU(),\n            nn.Conv2d(features, features * 4, 3, 1, 1),\n            nn.PixelShuffle(2),\n            nn.PReLU(),\n        )\n\n        self.final = nn.Sequential(\n            nn.Conv2d(features, out_channels, kernel_size=9, padding=4),\n            nn.Tanh()\n        )\n\n    def forward(self, x):\n        x1 = self.initial(x)\n        res = x1\n        for block in self.res_blocks:\n            res = res + block(res)\n        out = self.mid_conv(res)\n        out = out + x1\n        out = self.upsample(out)\n        return self.final(out)\n\n"})}),"\n",(0,l.jsx)(e.h2,{id:"3-\u591a\u5c3a\u5ea6\u7279\u5f81\u878d\u5408\u7248",children:"3. \u591a\u5c3a\u5ea6\u7279\u5f81\u878d\u5408\u7248"}),"\n",(0,l.jsx)(e.p,{children:"\u7f51\u7edc\u7ed3\u6784\u4e2d\u5f15\u5165\u591a\u5c3a\u5ea6\u7279\u5f81\u5904\u7406\u6a21\u5757\uff08\u5982\u4f7f\u7528 3x3\u30015x5\u30017x7 \u4e0d\u540c\u5377\u79ef\u6838\u6216\u91d1\u5b57\u5854\u7ed3\u6784\uff09\uff0c\u5e76\u5c06\u4e0d\u540c\u5c3a\u5ea6\u7279\u5f81\u62fc\u63a5\u6216\u52a0\u6743\u878d\u5408\uff0c\u6700\u540e\u6dfb\u52a0\u81f3 SRResNetGenerator \u5185\u90e8\u7ed3\u6784\u4e2d"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{children:"class MultiScaleFeatureFusion(nn.Module):\n    def __init__(self, in_channels, features):\n        super(MultiScaleFeatureFusion, self).__init__()\n        # \u4f7f\u7528\u81a8\u80c0\u5377\u79ef\u589e\u52a0\u611f\u53d7\u91ce\n        self.scale1 = nn.Conv2d(in_channels, features, kernel_size=3, padding=1, dilation=1)\n        self.scale2 = nn.Conv2d(in_channels, features, kernel_size=5, padding=2, dilation=1)\n        self.scale3 = nn.Conv2d(in_channels, features, kernel_size=7, padding=3, dilation=1)\n\n        self.fusion = nn.Conv2d(features * 3, features, kernel_size=1)\n\n    def forward(self, x):\n        x1 = self.scale1(x)\n        x2 = self.scale2(x)\n        x3 = self.scale3(x)\n        fused = torch.cat([x1, x2, x3], dim=1)\n        return self.fusion(fused)\n\n\nclass SRResNetGenerator(nn.Module):\n    def __init__(self, in_channels=2, out_channels=2, features=64):\n        super(SRResNetGenerator, self).__init__()\n        self.initial = nn.Sequential(\n            nn.Conv2d(in_channels, features, kernel_size=9, padding=4),\n            nn.PReLU()\n        )\n\n        # Multi-scale feature fusion module\n        self.multi_scale_fusion = MultiScaleFeatureFusion(in_channels=features, features=features)\n\n        # \u4fee\u6539\u6b8b\u5dee\u5757\uff0c\u4f7f\u7528\u81a8\u80c0\u5377\u79ef\n        res_blocks = []\n        for _ in range(8):  # \u4fdd\u630116\u4e2a\u6b8b\u5dee\u5757\n            res_blocks.append(nn.Sequential(\n                nn.Conv2d(features, features, kernel_size=3, padding=2, dilation=2),  # \u4f7f\u7528\u81a8\u80c0\u5377\u79ef\n                nn.BatchNorm2d(features),\n                nn.PReLU(),\n                nn.Conv2d(features, features, kernel_size=3, padding=2, dilation=2),  # \u4f7f\u7528\u81a8\u80c0\u5377\u79ef\n                nn.BatchNorm2d(features)\n            ))\n        self.res_blocks = nn.Sequential(*res_blocks)\n\n        self.mid_conv = nn.Sequential(\n            nn.Conv2d(features, features, kernel_size=3, padding=1),\n            nn.BatchNorm2d(features)\n        )\n\n        self.upsample = nn.Sequential(\n            nn.Conv2d(features, features * 4, 3, 1, 1),\n            nn.PixelShuffle(2),\n            nn.PReLU(),\n            nn.Conv2d(features, features * 4, 3, 1, 1),\n            nn.PixelShuffle(2),\n            nn.PReLU(),\n        )\n\n        self.final = nn.Sequential(\n            nn.Conv2d(features, out_channels, kernel_size=9, padding=4),\n            nn.Tanh()\n        )\n\n    def forward(self, x):\n        x1 = self.initial(x)\n\n        # Multi-scale feature fusion\n        x2 = self.multi_scale_fusion(x1)\n\n        res = x1 + x2  # Combine initial and multi-scale fused features\n\n        for block in self.res_blocks:\n            res = res + block(res)  # Residual learning\n\n        out = self.mid_conv(res)\n        out = out + x1  # Add skip connection from initial input\n        out = self.upsample(out)\n        return self.final(out)\n"})}),"\n",(0,l.jsx)(e.h2,{id:"4-\u878d\u5408",children:"4. \u878d\u5408"}),"\n",(0,l.jsx)(e.p,{children:"\u540c\u65f6\u91c7\u7528\uff1a\n\xb7 \u611f\u77e5 + MS-SSIM + MSE + GAN \u635f\u5931\uff1b\n\xb7 \u591a\u5c3a\u5ea6\u7ed3\u6784\uff1b\n\xb7 \u901a\u9053\u6ce8\u610f\u529b\uff1b"}),"\n",(0,l.jsx)(e.h2,{id:"5-\u603b\u7ed3",children:"5. \u603b\u7ed3"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"\u5b9e\u9a8c\u540d\u79f0"}),(0,l.jsx)(e.th,{children:"\u6539\u8fdb\u70b9\u7c7b\u578b"}),(0,l.jsx)(e.th,{children:"\u4e3b\u8981\u64cd\u4f5c"}),(0,l.jsx)(e.th,{children:"\u4f5c\u7528"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"1. \u635f\u5931\u51fd\u6570\u6539\u8fdb"})}),(0,l.jsx)(e.td,{children:"\u635f\u5931\u51fd\u6570\u5c42\u9762"}),(0,l.jsxs)(e.td,{children:["\u5f15\u5165 ",(0,l.jsx)(e.strong,{children:"\u591a\u79cd\u635f\u5931\u7ec4\u5408"}),"\uff0c\u5982\u611f\u77e5\u635f\u5931\uff08VGG\uff09\u3001MS-SSIM \u7b49"]}),(0,l.jsx)(e.td,{children:"\u66f4\u7b26\u5408\u4eba\u7c7b\u89c6\u89c9\u611f\u77e5\uff0c\u63d0\u5347\u56fe\u50cf\u8d28\u91cf"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"2. \u901a\u9053\u6ce8\u610f\u529b\u673a\u5236"})}),(0,l.jsx)(e.td,{children:"\u7f51\u7edc\u7ed3\u6784\u5c42\u9762"}),(0,l.jsxs)(e.td,{children:["\u5728\u751f\u6210\u5668\u4e2d\u52a0\u5165 ",(0,l.jsx)(e.strong,{children:"\u901a\u9053\u6ce8\u610f\u529b\u6a21\u5757\uff08\u5982 SE/CA\uff09"})]}),(0,l.jsx)(e.td,{children:"\u81ea\u9002\u5e94\u5173\u6ce8\u91cd\u8981\u7279\u5f81\u901a\u9053\uff0c\u63d0\u5347\u8868\u793a\u80fd\u529b"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"3. \u591a\u5c3a\u5ea6\u7279\u5f81\u878d\u5408"})}),(0,l.jsx)(e.td,{children:"\u7f51\u7edc\u7ed3\u6784\u5c42\u9762"}),(0,l.jsx)(e.td,{children:"\u5f15\u5165\u591a\u4e2a\u5c3a\u5ea6\uff08\u4e0d\u540c\u5c3a\u5bf8\u5377\u79ef\u6838\u6216\u4e0b\u91c7\u6837\u8def\u5f84\uff09\u8fdb\u884c\u7279\u5f81\u878d\u5408"}),(0,l.jsx)(e.td,{children:"\u66f4\u597d\u4fdd\u7559\u56fe\u50cf\u7eb9\u7406\u548c\u7ec6\u8282"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"4. \u878d\u5408\u6a21\u578b"})}),(0,l.jsx)(e.td,{children:"\u7efc\u5408\u589e\u5f3a"}),(0,l.jsx)(e.td,{children:"\u540c\u65f6\u5f15\u5165\u6ce8\u610f\u529b + \u591a\u5c3a\u5ea6 + \u6539\u8fdb\u635f\u5931"}),(0,l.jsx)(e.td,{children:"\u534f\u540c\u63d0\u5347\u6027\u80fd\uff0c\u9a8c\u8bc1\u7ec4\u5408\u4f18\u52bf"})]})]})]})]})}function d(s={}){const{wrapper:e}={...(0,i.R)(),...s.components};return e?(0,l.jsx)(e,{...s,children:(0,l.jsx)(h,{...s})}):h(s)}},28453:(s,e,n)=>{n.d(e,{R:()=>t,x:()=>r});var a=n(96540);const l={},i=a.createContext(l);function t(s){const e=a.useContext(i);return a.useMemo(function(){return"function"==typeof s?s(e):{...e,...s}},[e,s])}function r(s){let e;return e=s.disableParentContext?"function"==typeof s.components?s.components(l):s.components||l:t(s.components),a.createElement(i.Provider,{value:e},s.children)}},77367:s=>{s.exports=JSON.parse('{"permalink":"/blog/12-Related GANs and their SRGAN ablation experiments","editUrl":"https://github.com/yourrepo/blog/12-Related GANs and their SRGAN ablation experiments.md","source":"@site/blog/12-Related GANs and their SRGAN ablation experiments.md","title":"Related GANs and their SRGAN ablation experiments","description":"\u672c\u6587\u5c06\u4ece\u4e09\u90e8\u5206\uff0c\u5373 GAN \u6a21\u578b\u7684\u7406\u8bba\u90e8\u5206\uff0c\u4ee3\u7801\uff08\u5b9e\u8df5\uff09\u90e8\u5206\u53ca SRGAN \u7684\u6d88\u878d\u8bd5\u9a8c\u90e8\u5206\u5c55\u5f00\u4ecb\u7ecd","date":"2025-06-16T00:00:00.000Z","tags":[],"readingTime":21.15,"hasTruncateMarker":true,"authors":[{"name":"zqqqj","title":"super bug engineer 4 nlp,robot,cv,ml and ds","url":"https://github.com/zqqqqqqj1110","imageURL":"https://avatars.githubusercontent.com/u/95482898?v=4","key":"zqqqj","page":null}],"frontMatter":{"title":"Related GANs and their SRGAN ablation experiments","authors":["zqqqj"],"tags":[],"date":"2025-06-16T00:00:00.000Z"},"unlisted":false,"prevItem":{"title":"Machine learning based spectral methods for partial differential equations","permalink":"/blog/13-Deep Learning-Based Numerical Methods for High-Dimensional Parabolic Partial Differential Equations and Backward Stochastic Differential Equations"},"nextItem":{"title":"Automated and Context-Aware Repair of Color-Related Accessibility Issues for Android Apps","permalink":"/blog/05-Automated and Context-Aware Repair of Color-Related Accessibility Issues for Android Apps"}}')}}]);